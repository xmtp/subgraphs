specVersion: 1.2.0
schema:
    file: ./schema.graphql
dataSources:
    - kind: ethereum
      name: PayerRegistry
      network: base-sepolia
      source:
          abi: PayerRegistry
          address: '0x3Ce54917177666d1a331fbb3F208a3B91218EC00'
          startBlock: 26552435
      mapping:
          kind: ethereum/events
          apiVersion: 0.0.9
          language: wasm/assemblyscript
          entities:
              - PayerRegistryBalanceSnapshot
              - PayerRegistryPendingWithdrawalSnapshot
              - PayerRegistryWithdrawableTimestampSnapshot
              - PayerRegistryDepositedSnapshot
              - PayerRegistryIncurredDebtSnapshot
              - PayerRegistryRepaidDebtSnapshot
              - PayerRegistryWithdrawnSnapshot
              - PayerRegistryUsageSettledSnapshot
              - PayerRegistryDeposit
              - PayerRegistryWithdrawal
              - PayerRegistryUsageSettlement
              - Payer
              - PayerRegistryPausedSnapshot
              - PayerRegistryTotalDepositsSnapshot
              - PayerRegistryTotalDebtSnapshot
              - PayerRegistryWithdrawLockPeriodSnapshot
              - PayerRegistryMinimumDepositSnapshot
              - PayerRegistrySettlerSnapshot
              - PayerRegistryFeeDistributorSnapshot
              - PayerRegistryTotalWithdrawableSnapshot
              - PayerRegistryExcessSnapshot
              - PayerRegistryTotalBalanceSnapshot
              - PayerRegistryTotalPendingWithdrawalsSnapshot
              - PayerRegistryTotalDepositedSnapshot
              - PayerRegistryTotalIncurredDebtSnapshot
              - PayerRegistryTotalRepaidDebtSnapshot
              - PayerRegistryTotalWithdrawnSnapshot
              - PayerRegistryTotalUsageSettledSnapshot
              - PayerRegistryTotalExcessTransferredSnapshot
              - PayerRegistryBatchUsageSettlement
              - PayerRegistryExcessTransfer
              - PayerRegistry
          abis:
              - name: PayerRegistry
                file: ./abis/PayerRegistry.abi.json
          eventHandlers:
              - event: Deposit(indexed address,uint96)
                handler: handleDeposit
              - event: ExcessTransferred(uint96)
                handler: handleExcessTransferred
              - event: FeeDistributorUpdated(indexed address)
                handler: handleFeeDistributorUpdated
              - event: MinimumDepositUpdated(uint96)
                handler: handleMinimumDepositUpdated
              - event: PauseStatusUpdated(indexed bool)
                handler: handlePauseStatusUpdated
              - event: SettlerUpdated(indexed address)
                handler: handleSettlerUpdated
              - event: UsageSettled(indexed address,uint96)
                handler: handleUsageSettled
              - event: WithdrawLockPeriodUpdated(uint32)
                handler: handleWithdrawLockPeriodUpdated
              - event: WithdrawalCancelled(indexed address)
                handler: handleWithdrawalCancelled
              - event: WithdrawalFinalized(indexed address)
                handler: handleWithdrawalFinalized
              - event: WithdrawalRequested(indexed address,uint96,uint32)
                handler: handleWithdrawalRequested
          file: ./src/payer-registry.ts
    - kind: ethereum
      name: FeeToken
      network: base-sepolia
      source:
          abi: FeeToken
          address: '0x036CbD53842c5426634e7929541eC2318f3dCF7e'
          startBlock: 26552435
          endBlock: 26552435 # Remove this when this is FeeToken/xUSD.
      context:
          payerRegistry:
              type: String
              data: '0x3Ce54917177666d1a331fbb3F208a3B91218EC00'
      mapping:
          kind: ethereum/events
          apiVersion: 0.0.9
          language: wasm/assemblyscript
          entities:
              - PayerRegistry
              - PayerRegistryFeeTokenBalanceSnapshot
              - PayerRegistryExcessSnapshot
          abis:
              - name: FeeToken
                file: ./abis/FeeToken.abi.json
          eventHandlers:
              - event: Transfer(indexed address,indexed address,uint256)
                handler: handleTransfer
          file: ./src/fee-token.ts
