# ============ Generic - Snapshot Interfaces ============ #

interface SnapshotEntity {
    id: ID! @unique
    timestamp: Timestamp! @index
}

interface IntSnapshotEntity implements SnapshotEntity {
    id: ID! @unique
    timestamp: Timestamp! @index
    value: Int!
}

interface BigIntSnapshotEntity implements SnapshotEntity {
    id: ID! @unique
    timestamp: Timestamp! @index
    value: BigInt!
}

interface TimestampSnapshotEntity implements SnapshotEntity {
    id: ID! @unique
    timestamp: Timestamp! @index
    value: Timestamp!
}

interface StringSnapshotEntity implements SnapshotEntity {
    id: ID! @unique
    timestamp: Timestamp! @index
    value: String!
}

interface BooleanSnapshotEntity implements SnapshotEntity {
    id: ID! @unique
    timestamp: Timestamp! @index
    value: Boolean!
}

# ============ Account - Snapshot Interfaces ============ #

interface AccountSnapshotEntity implements SnapshotEntity {
    id: ID! @unique
    timestamp: Timestamp! @index
    account: Account! @index
}

# ============ Account - Lifetime Total Snapshots ============ #

type GroupMessagesSentSnapshot implements AccountSnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @index
    account: Account! @index
    value: BigInt!
}

type GroupMessageBytesSentSnapshot implements AccountSnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @index
    account: Account! @index
    value: BigInt!
}

type GroupMessageTransactionFeesSnapshot implements AccountSnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @index
    account: Account! @index
    value: BigInt!
}

type IdentityUpdatesCreatedSnapshot implements AccountSnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @index
    account: Account! @index
    value: BigInt!
}

type IdentityUpdateBytesCreatedSnapshot implements AccountSnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @index
    account: Account! @index
    value: BigInt!
}

type IdentityUpdateTransactionFeesSnapshot implements AccountSnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @index
    account: Account! @index
    value: BigInt!
}

type TransactionFeesSnapshot implements AccountSnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @index
    account: Account! @index
    value: BigInt!
}

type WithdrawnSnapshot implements AccountSnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @index
    account: Account! @index
    value: BigInt!
}

type DepositsReceivedSnapshot implements AccountSnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @index
    account: Account! @index
    value: BigInt!
}

# ============ Account - Event Entities ============ #

type GroupMessage @entity(immutable: true) {
    id: ID! @unique
    account: Account! @index
    groupId: String! @index
    sequenceId: BigInt! @index
    messageSize: Int!
    timestamp: Timestamp!
    transactionHash: String!
    logIndex: BigInt!
    transactionFee: BigInt!
}

type IdentityUpdate @entity(immutable: false) {
    id: ID! @unique
    account: Account! @index
    inboxId: String! @index
    sequenceId: BigInt! @index
    identityUpdateSize: Int!
    timestamp: Timestamp!
    transactionHash: String!
    logIndex: BigInt!
    transactionFee: BigInt!
}

# ============ Account - Entity ============ #

type Account @entity(immutable: false) {
    # Entity Properties
    id: ID! @unique
    lastUpdate: Timestamp!
    address: String! @unique

    # Lifetime Totals (and snapshots)
    groupMessagesSent: BigInt!
    groupMessagesSentSnapshots: [GroupMessagesSentSnapshot!] @derivedFrom(field: "account")
    groupMessageBytesSent: BigInt!
    groupMessageBytesSentSnapshots: [GroupMessageBytesSentSnapshot!] @derivedFrom(field: "account")
    groupMessageTransactionFees: BigInt!
    groupMessageTransactionFeesSnapshots: [GroupMessageTransactionFeesSnapshot!] @derivedFrom(field: "account")
    identityUpdatesCreated: BigInt!
    identityUpdatesCreatedSnapshots: [IdentityUpdatesCreatedSnapshot!] @derivedFrom(field: "account")
    identityUpdateBytesCreated: BigInt!
    identityUpdateBytesCreatedSnapshots: [IdentityUpdateBytesCreatedSnapshot!] @derivedFrom(field: "account")
    identityUpdateTransactionFees: BigInt!
    identityUpdateTransactionFeesSnapshots: [IdentityUpdateTransactionFeesSnapshot!] @derivedFrom(field: "account")
    transactionFees: BigInt!
    transactionFeesSnapshots: [TransactionFeesSnapshot!] @derivedFrom(field: "account")
    withdrawn: BigInt!
    withdrawnSnapshots: [WithdrawnSnapshot!] @derivedFrom(field: "account")
    depositsReceived: BigInt!
    depositsReceivedSnapshots: [DepositsReceivedSnapshot!] @derivedFrom(field: "account")

    # Event Entities
    groupMessages: [GroupMessage!] @derivedFrom(field: "account")
    identityUpdates: [IdentityUpdate!] @derivedFrom(field: "account")
    withdrawals: [AppChainGatewayWithdrawal!] @derivedFrom(field: "account")
    receivedDeposits: [AppChainGatewayDeposit!] @derivedFrom(field: "recipient")
}

# ============ GroupMessageBroadcaster - Snapshot Interfaces ============ #

interface GroupMessageBroadcasterSnapshotEntity implements SnapshotEntity {
    id: ID! @unique
    timestamp: Timestamp! @index
}

# ============ GroupMessageBroadcaster - State Variable Snapshots ============ #

type GroupMessageBroadcasterMinPayloadSizeSnapshot implements GroupMessageBroadcasterSnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @unique @index
    value: BigInt!
}

type GroupMessageBroadcasterMaxPayloadSizeSnapshot implements GroupMessageBroadcasterSnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @unique @index
    value: BigInt!
}

type GroupMessageBroadcasterPausedSnapshot implements GroupMessageBroadcasterSnapshotEntity & BooleanSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @unique @index
    value: Boolean!
}

type GroupMessageBroadcasterPayloadBootstrapperSnapshot implements GroupMessageBroadcasterSnapshotEntity & StringSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @unique @index
    value: String!
}

# ============ GroupMessageBroadcaster - Lifetime Total Snapshots ============ #

type GroupMessageBroadcasterTotalMessagesSentSnapshot implements GroupMessageBroadcasterSnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @unique @index
    value: BigInt!
}

type GroupMessageBroadcasterTotalMessageBytesSentSnapshot implements GroupMessageBroadcasterSnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @unique @index
    value: BigInt!
}

type GroupMessageBroadcasterTotalMessageTransactionFeesSnapshot implements GroupMessageBroadcasterSnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @unique @index
    value: BigInt!
}

# ============ GroupMessageBroadcaster - Entity ============ #

type GroupMessageBroadcaster @entity(immutable: false) {
    # Entity Properties
    id: ID! @unique
    lastUpdate: Timestamp!

    # State Variables (and snapshots)
    minPayloadSize: BigInt!
    maxPayloadSize: BigInt!
    paused: Boolean!
    payloadBootstrapper: String!

    # Lifetime Totals (and snapshots)
    totalMessagesSent: BigInt!
    totalMessageBytesSent: BigInt!
    totalMessageTransactionFees: BigInt!
}

# ============ IdentityUpdateBroadcaster - Snapshot Interfaces ============ #

interface IdentityUpdateBroadcasterSnapshotEntity implements SnapshotEntity {
    id: ID! @unique
    timestamp: Timestamp! @index
}

# ============ IdentityUpdateBroadcaster - State Variable Snapshots ============ #

type IdentityUpdateBroadcasterMinPayloadSizeSnapshot implements IdentityUpdateBroadcasterSnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @unique @index
    value: BigInt!
}

type IdentityUpdateBroadcasterMaxPayloadSizeSnapshot implements IdentityUpdateBroadcasterSnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @unique @index
    value: BigInt!
}

type IdentityUpdateBroadcasterPausedSnapshot implements IdentityUpdateBroadcasterSnapshotEntity & BooleanSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @unique @index
    value: Boolean!
}

type IdentityUpdateBroadcasterPayloadBootstrapperSnapshot implements IdentityUpdateBroadcasterSnapshotEntity & StringSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @unique @index
    value: String!
}

# ============ IdentityUpdateBroadcaster - Lifetime Total Snapshots ============ #

type IdentityUpdateBroadcasterTotalIdentityUpdatesCreatedSnapshot implements IdentityUpdateBroadcasterSnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @unique @index
    value: BigInt!
}

type IdentityUpdateBroadcasterTotalIdentityUpdateBytesCreatedSnapshot implements IdentityUpdateBroadcasterSnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @unique @index
    value: BigInt!
}

type IdentityUpdateBroadcasterTotalIdentityUpdateTransactionFeesSnapshot implements IdentityUpdateBroadcasterSnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @unique @index
    value: BigInt!
}

# ============ IdentityUpdateBroadcaster - Entity ============ #

type IdentityUpdateBroadcaster @entity(immutable: false) {
    # Entity Properties
    id: ID! @unique
    lastUpdate: Timestamp!

    # State Variables (and snapshots)
    minPayloadSize: BigInt!
    maxPayloadSize: BigInt!
    paused: Boolean!
    payloadBootstrapper: String!

    # Lifetime Totals (and snapshots)
    totalIdentityUpdatesCreated: BigInt!
    totalIdentityUpdateBytesCreated: BigInt!
    totalIdentityUpdateTransactionFees: BigInt!
}

# ============ AppChainParameterRegistry Parameter - Snapshot Interfaces ============ #

interface AppChainParameterRegistryParameterSnapshotEntity implements SnapshotEntity {
    id: ID! @unique
    timestamp: Timestamp! @index
    parameter: AppChainParameterRegistryParameter! @index
}

# ============ AppChainParameterRegistry Parameter - State Variable Snapshots ============ #

type AppChainParameterRegistryParameterValueSnapshot implements AppChainParameterRegistryParameterSnapshotEntity & StringSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @unique @index
    parameter: AppChainParameterRegistryParameter! @index
    value: String!
}

# ============ AppChainParameterRegistry Parameter - Entity ============ #

type AppChainParameterRegistryParameter @entity(immutable: false) {
    id: ID! @unique
    lastUpdate: Timestamp!
    key: String! @unique
    value: String!
    valueSnapshot: AppChainParameterRegistryParameterValueSnapshot! @derivedFrom(field: "parameter")
}

# ============ AppChainParameterRegistry - Entity ============ #

type AppChainParameterRegistry @entity(immutable: false) {
    # Entity Properties
    id: ID! @unique
    lastUpdate: Timestamp!
}

# ============ AppChainGateway - Snapshot Interfaces ============ #

interface AppChainGatewaySnapshotEntity implements SnapshotEntity {
    id: ID! @unique
    timestamp: Timestamp! @index
}

# ============ AppChainGateway - State Variable Snapshots ============ #

type AppChainGatewayPausedSnapshot implements AppChainGatewaySnapshotEntity & BooleanSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @unique @index
    value: Boolean!
}

# ============ AppChainGateway - Lifetime Total Snapshots ============ #

type AppChainGatewayTotalDepositsReceivedSnapshot implements AppChainGatewaySnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @unique @index
    value: BigInt!
}

type AppChainGatewayTotalWithdrawnSnapshot implements AppChainGatewaySnapshotEntity & BigIntSnapshotEntity & SnapshotEntity
    @entity(immutable: false) {
    id: ID! @unique
    timestamp: Timestamp! @unique @index
    value: BigInt!
}

# ============ AppChainGateway ReceivedParameter - Entity ============ #

type AppChainGatewayReceivedParameter @entity(immutable: true) {
    id: ID! @unique
    key: String! @unique
    event: AppChainGatewayParameterReceival!
}

# ============ AppChainParameterRegistry - Event Entities ============ #

type AppChainGatewayParameterReceival @entity(immutable: true) {
    id: ID! @unique
    parameters: [AppChainGatewayReceivedParameter!] @derivedFrom(field: "event")
    timestamp: Timestamp!
    transactionHash: String!
    logIndex: BigInt!
}

type AppChainGatewayWithdrawal @entity(immutable: true) {
    id: ID! @unique
    account: Account! @index
    recipient: String! @index
    amount: BigInt!
    messageId: BigInt! @index
    timestamp: Timestamp!
    transactionHash: String!
    logIndex: BigInt!
    transactionFee: BigInt!
}

type AppChainGatewayDeposit @entity(immutable: true) {
    id: ID! @unique
    recipient: Account! @index
    amount: BigInt!
    timestamp: Timestamp!
    transactionHash: String!
    logIndex: BigInt!
    transactionFee: BigInt!
}

# ============ AppChainParameterRegistry - Entity ============ #

type AppChainGateway @entity(immutable: false) {
    # Entity Properties
    id: ID! @unique
    lastUpdate: Timestamp!

    # State Variable Mappings
    paused: Boolean!

    # Lifetime Totals (and snapshots)
    totalWithdrawn: BigInt!
    totalDepositsReceived: BigInt!
}
